<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Mappa Leaflet Mare Blu Montagne Verdi</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.css"/>
<style>
html,body{margin:0;padding:0;height:100%;background:#000;}
#map{height:100vh;width:100%;position:relative;background:#000;}
.center-box{position:absolute;top:50%;left:50%;width:12px;height:12px;background:#e7354a;transform:translate(-50%,-50%);box-shadow:0 0 8px #e7354a;pointer-events:none;z-index:500;}
.coords{position:absolute;bottom:10px;left:10px;padding:6px 10px;font:13px monospace;color:#e7354a;background:rgba(0,0,0,.6);border-radius:4px;z-index:600;pointer-events:none;}
.leaflet-container{background:#000;}
</style>
</head>
<body>
<div id="map">
  <div class="center-box"></div>
  <div id="coordBox" class="coords">Lat: –, Lng: –</div>
</div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.js"></script>
<script src="https://unpkg.com/@maplibre/maplibre-gl-leaflet@0.0.18/leaflet-maplibre-gl.js"></script>
<script>
const map=L.map('map',{center:[43.77,11.25],zoom:7,zoomControl:true,minZoom:2});
const coordBox=document.getElementById('coordBox');
function upd(){const c=map.getCenter();coordBox.textContent=`Lat: ${c.lat.toFixed(5)}, Lng: ${c.lng.toFixed(5)}`;}
map.on('move',upd);
map.whenReady(upd);
const glLayer=L.maplibreGL({
  style:'https://demotiles.maplibre.org/style.json',
  interactive:false
}).addTo(map);
glLayer.on('load',()=>{
  const ml=glLayer.getMaplibreMap();
  ml.getStyle().layers.filter(l=>l.type==='background').forEach(l=>ml.setPaintProperty(l.id,'background-color','#000'));
  ml.getStyle().layers.filter(l=>/water/.test(l.id)).forEach(l=>{
    if(l.type==='fill'){ml.setPaintProperty(l.id,'fill-color','#0d55c9');ml.setPaintProperty(l.id,'fill-opacity',1);}
    if(l.type==='line'){try{ml.setPaintProperty(l.id,'line-color','#1980ff');}catch(e){}}
  });
  const labelLayer=ml.getStyle().layers.find(l=>l.type==='symbol'&&l.layout&&l.layout['text-field']);
  if(!ml.getLayer('veg')){
    try{
      ml.addLayer({
        id:'veg',
        type:'fill',
        source:Object.keys(ml.getStyle().sources)[0],
        'source-layer':'landcover',
        filter:['in','class','forest','wood','grass','scrub','park','rock','glacier'],
        paint:{
          'fill-color':['match',['get','class'],'glacier','#4fe3ff','rock','#18763a','#0d7d35'],
          'fill-opacity':['interpolate',['linear'],['zoom'],5,0.35,8,0.5,12,0.6]
        }
      },labelLayer?labelLayer.id:undefined);
    }catch(e){}
  }
});
window.addEventListener('resize',()=>map.invalidateSize());
</script>
</body>
</html>
